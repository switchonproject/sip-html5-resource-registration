var app=angular.module("de.cismet.sip-html5-resource-registration",["ngAnimate","ngSanitize","ui.bootstrap","leaflet-directive","mgo-angular-wizard","ui.select","uuid","de.cismet.sip-html5-resource-registration.controllers","de.cismet.sip-html5-resource-registration.directives","de.cismet.sip-html5-resource-registration.services","de.cismet.sip-html5-resource-registration.factories","de.cismet.sip-html5-resource-registration.filters"]);app.config(["$logProvider",function(a){"use strict";a.debugEnabled(!1)}]),angular.module("de.cismet.sip-html5-resource-registration.controllers",[]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.geoLocationController",["$scope","$resource","AppConfig","leafletData","de.cismet.sip-html5-resource-registration.services.geoTools","de.cismet.sip-html5-resource-registration.services.dataset","de.cismet.sip-html5-resource-registration.services.CountriesService","de.cismet.sip-html5-resource-registration.services.featureRendererService",function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;p=f.$geoserverUploaded?e.readOnlyStyle:e.defaultStyle,q=e.countriesStyle,r=e.defaultDrawOptions,s=e.noDrawOptions,u=e.readSpatialCoverage,t=e.writeSpatialCoverage,j=e.fireResize,i=this,i.config=c,i.dataset=f,i.readOnly=f.$geoserverUploaded,i.contentLocation={},i.contentLocation.name="",i.contentLocation.bounds={},i.countries=[],i.countries["countries-world"]=g.getCountryList("countries-world"),i.countries["countries-europe"]=g.getCountryList("countries-europe"),i.onSelectedCountry=function(a){var b=new Wkt.Wkt;b.read(a.wkt);var c=b.toObject(p);o.clearLayers(),o.addLayer(c),d.getMap("mainmap").then(function(a){a.fitBounds(o.getBounds(),{animate:!0,pan:{animate:!0,duration:.6},zoom:{animate:!0}})})},a.forms={},a.mapData.center=i.config.mapView.home,a.mapData.defaults={tileLayer:i.config.mapView.backgroundLayer,minZoom:i.config.minZoom,path:p},a.mapData.layers={baselayers:i.config.mapView.baselayers},a.wizard.enterValidators["Geographic Location"]=function(b){if(b.valid===!0){i.readOnly?a.message.text="The spatial extent of the dataset has already been defined by the uploaded spatial dataset (e.g. SHP File) It cannot be changed afterwards.":i.mode.drawBBox===!0?a.message.text="Please specify the spatial extent of the dataset in the map <br>Use the map controls to draw a bounding box or a polygon that represents the spatial extent of the dataset.":a.message.text="Please specify the spatial extent of the dataset in the map.",a.message.icon="fa-info-circle",a.message.type="success",j("mainmap");var c=u(i.dataset);void 0!==c&&null!==c&&(o.clearLayers(),o.addLayer(c),d.getMap("mainmap").then(function(a){setTimeout(function(){a.fitBounds(c,{animate:!0,pan:{animate:!0,duration:.75},zoom:{animate:!0}})},100)})),i.readOnly&&void 0===y&&(y=h.getFeatureRenderer(i.dataset),y&&(y.setOpacity(1),d.getMap("mainmap").then(function(a){a.addLayer(y)})))}return b.valid},a.wizard.exitValidators["Geographic Location"]=function(b){if(b.valid=!0,i.mode.defineBBox===!0&&a.forms.coordinatesForm.$invalid?(a.message.text="Please specify a valid bounding box or use an other option to specify the geographic location of the dataset!",a.message.icon="fa-warning",a.message.type="warning",b.valid=!1):o&&o.getLayers()&&0!==o.getLayers().length||(a.message.text="Please specify the geographic location (spatial extent) of the dataset!",a.message.icon="fa-warning",a.message.type="warning",b.valid=!1),b.valid===!0){a.wizard.hasError=null;var c;o.getLayers().length>1?o.getLayers().forEach(function(a){if(c){var b=(new Wkt.Wkt).fromObject(a);"multipolygon"===b.type&&"polygon"===c.type?(b.merge(c),c=b):c.merge(b)}else c=(new Wkt.Wkt).fromObject(a)}):c=(new Wkt.Wkt).fromObject(o.getLayers()[0]),t(i.dataset,c.write())}return b.valid},i.mode={},i.mode.drawBBox=!0,i.mode.selectEC=!1,i.mode.selectWC=!1,i.mode.defineBBox=!1,i.mode.selectCountry=!1,i.switchMode=function(b){if(Object.keys(i.mode).forEach(function(a){b===a?i.mode[a]===!1&&(i.mode[a]=!0):i.mode[a]=!1},i.mode),a.message.icon="fa-info-circle",a.message.type="success",i.mode.drawBBox!==!0||v?i.mode.drawBBox!==!0&&v&&(n.setDrawingOptions(s),d.getMap("mainmap").then(function(a){a.removeControl(n)}),v=!1):(a.message.text="Please use the map controls to draw a bounding box or a polygon that represents the spatial extent of the dataset.",n.setDrawingOptions(r),d.getMap("mainmap").then(function(a){a.addControl(n)}),v=!0),i.mode.selectCountry===!0?(d.getMap("mainmap").then(function(a){a.addLayer(x)}),a.message.text="Select one or more countries that represent the spatial extent of the dataset."):d.getMap("mainmap").then(function(a){a.removeLayer(x)}),i.mode.selectEC===!0&&(a.message.text="Select a European country or region that represents the spatial extent of the dataset."),this.mode.selectWC===!0&&(a.message.text="Select a World country or region that represents the spatial extent of the dataset."),i.mode.defineBBox===!0&&(a.message.text="Please enter a bounding box with westbound and eastbound longitudes, and southbound and northbound latitudes in decimal degrees, with a precision of at least two decimals.",o.getLayers().length>0)){var c=o.getBounds();i.contentLocation.bounds={},i.contentLocation.bounds.west=c.getWest(),i.contentLocation.bounds.south=c.getSouth(),i.contentLocation.bounds.east=c.getEast(),i.contentLocation.bounds.north=c.getNorth()}},i.applyBoundingBox=function(){if(void 0!==i.contentLocation.bounds.south&&void 0!==i.contentLocation.bounds.west&&void 0!==i.contentLocation.bounds.north&&void 0!==i.contentLocation.bounds.east){var a=[[i.contentLocation.bounds.south,i.contentLocation.bounds.west],[i.contentLocation.bounds.north,i.contentLocation.bounds.east]],b=L.rectangle(a,p);o.clearLayers(),o.addLayer(b),d.getMap("mainmap").then(function(a){a.fitBounds(b,{animate:!0,pan:{animate:!0,duration:.6},zoom:{animate:!0}})}),i.contentLocation.name="New user-defined Bounding Box"}},k=i.config.mapView.maxBounds&&angular.isArray(i.config.mapView.maxBounds.southWest)?L.latLng(i.config.mapView.maxBounds.southWest[0],i.config.mapView.maxBounds.southWest[1]):L.latLng(90,-180),l=i.config.mapView.maxBounds&&angular.isArray(i.config.mapView.maxBounds.northEast)?L.latLng(i.config.mapView.maxBounds.northEast[0],i.config.mapView.maxBounds.northEast[1]):L.latLng(-90,180),m=L.latLngBounds(k,l),d.getMap("mainmap").then(function(b){b.setMaxBounds(a.maxBounds)}),w=b(i.config.mapView.countriesLayer),w.get(function(a){var b=function(a,b){b.bindPopup(a.properties.name),b.on("click",function(a){var b=!0;if(o.getLayers().forEach(function(c){c.properties?a.target.feature.properties.name===c.properties.name&&(b=!1,o.removeLayer(c)):o.removeLayer(c)}),b){var c=new Wkt.Wkt,d=c.read(JSON.stringify(a.target.feature)),e=c.toObject(d);e.on("click",function(a){o.removeLayer(a.target)}),o.addLayer(e)}})};x=new L.GeoJSON(a,{style:q,onEachFeature:b})}),o=new L.FeatureGroup,n=new L.Control.Draw({draw:r,edit:{featureGroup:o}}),v=!0,d.getMap("mainmap").then(function(a){a.addLayer(o),i.readOnly||(a.addControl(n),a.on("draw:created",function(a){o.clearLayers(),o.addLayer(a.layer),i.contentLocation={},i.contentLocation.name="New "+a.layerType}),a.on("draw:edited",function(){i.contentLocation=Object.create(i.contentLocation),-1===i.contentLocation.name.indexOf("(edited)")&&(i.contentLocation.name+=" (edited)")}),a.on("draw:deleted",function(a){console.log(a.layers.getLayers().length+" deleted"),o.clearLayers(),i.contentLocation=null}))})}]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.keywordsController",["$scope","de.cismet.sip-html5-resource-registration.services.dataset",function(a,b){"use strict";var c;c=this,c.dataset=b,c.toggleSelection=function(b){var d=c.dataset.tags.indexOf(b);d>-1?a.dataset.tags.splice(d,1):a.dataset.tags.push(b)}}]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.licenseController",["$scope","de.cismet.sip-html5-resource-registration.services.dataset","de.cismet.sip-html5-resource-registration.services.TagGroupService",function(a,b,c){"use strict";var d=this;d.dataset=b,a.tags.accessconditions=c.getTagList("access conditions","Creative Commons (CC BY),Creative Commons (CC BY-NC),Creative Commons (CC BY-NC-ND),Creative Commons (CC BY-NC-SA),Creative Commons (CC BY-ND),Creative Commons (CC BY-SA),for research only,no limitations,other"),a.wizard.enterValidators["License and Conditions"]=function(b){return b.valid===!0&&(a.message.text="Please select a predefined license for regulating the conditions for access and use of the dataset and / or provide a brief statement or URL to the license which applies to the usage of the dataset. This statement should provide additional information.",a.message.icon="fa-info-circle",a.message.type="success"),b.valid},a.wizard.exitValidators["License and Conditions"]=function(b){b.valid=!0;var c=a.tags.accessconditions.every(function(a){return d.dataset.accessconditions&&d.dataset.accessconditions.name&&a.name===d.dataset.accessconditions.name?(d.dataset.accessconditions=a,!1):!0});return c?(a.message.text="Please select a valid access condition (e.g. no limitations).",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetAccessconditions",b.valid=!1):a.licenseForm.datasetLicensestatement.$error.required?(a.message.text="Please provide a description of the license of type <i>other</i> or select another license from the list.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetLicensestatement",b.valid=!1):a.licenseForm.datasetContactemail.$error.email?(a.message.text="The email address of the contact person is not a valid.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContactperson",b.valid=!1):a.licenseForm.datasetOrganisationurl.$error.url&&(a.message.text="The website url of the organisation is not a valid <a href='https://en.wikipedia.org/wiki/Uniform_Resource_Locator#Syntax' target='_blank' title='Uniform Resource Locator'>URL</a>.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetOrganisation",b.valid=!1),b.valid===!0&&(a.wizard.hasError=null),b.valid}}]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.masterController",["$scope","AppConfig","de.cismet.sip-html5-resource-registration.services.dataset","$modal",function(a,b,c,d){"use strict";var e;e=this,e.config=b,e.dataset=c,a.dataset=c,a.config=b,a.tags=[],a.message={},a.message.text="<strong>Welcome to the SWITCH-ON tool for the registration of (hydrological) open-data in the <a href='http://www.water-switch-on.eu/sip-webclient/sip-beta/' title='Find open data with the SIP BYOD Client' target='_blank'>SWITCH-ON Spatial Information Platform</a>!</strong> <br>Please provide some general information about the new dataset such as name, description, a (download) link and keywords. ",a.message.icon="fa-info-circle",a.message.type="success",a.showInfoMessage=function(b,c,d){a.message.text=b,a.message.type=c?c:"success",a.message.icon=d?d:"fa-info-circle"},a.wizard={},a.wizard.uploadchoice=!1,a.wizard.enterValidators=[],a.wizard.exitValidators=[],a.wizard.currentStep="",a.wizard.canProceed=!0,a.wizard.canGoBack=!1,a.wizard.hasError=!1,a.wizard.proceedButtonText="Next",a.wizard.isFinishStep=function(){return"Summary"===a.wizard.currentStep},a.wizard.isFirstStep=function(){return"Dataset Description"===a.wizard.currentStep},a.mapData={},a.$watch("wizard.currentStep",function(b){b?(a.wizard.isFinishStep()?a.wizard.proceedButtonText="Finish":a.wizard.proceedButtonText="Next",a.wizard.canGoBack=!a.wizard.isFirstStep()):a.wizard.proceedButtonText="Next"}),e.finishedWizard=function(){d.open({animation:!0,templateUrl:"templates/confirmation.html",controller:"de.cismet.sip-html5-resource-registration.controllers.storageController",controllerAs:"storageController",keyboard:"false",size:"lg",backdrop:"static"})}}]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.odRegistrationController",["$scope","$modal","$location","AppConfig","de.cismet.sip-html5-resource-registration.services.dataset","de.cismet.sip-html5-resource-registration.services.TagGroupService","de.cismet.sip-html5-resource-registration.services.searchService",function(a,b,c,d,e,f,g){"use strict";var h,i;i=void 0,h=this,h.dataset=e,h.config=d,h.groupBy=function(a){return a.name.indexOf(",")>-1?a.name.split(",",1)[0]:a.name.split(" ",1)[0]},h.checkLink=function(b){if(b){var c,e,f;e=function(b){b&&b.$collection&&b.$collection.length>0?(i='This dataset is already registered in the SWITCH-ON Spatial Information Platform under the name </strong>"'+b.$collection[0].name+'"</strong>. Click <a href="'+d.byod.baseUrl+"/#/resource/"+b.$collection[0].id+'" title="'+b.$collection[0].name+'" target="_blank">here</a> to view the dataset meta-data.',a.message.text=i,a.message.icon="fa-warning",a.message.type="info",a.wizard.hasError="datasetContentlocation"):("datasetContentlocation"===a.wizard.hasError&&(a.wizard.hasError=null),i=void 0)},f=function(a){console.error("search error: "+a),i=void 0},c=g.search(b).$promise.then(e,f)}i=void 0},h.selectKeywords=function(){b.open({animation:!0,templateUrl:"templates/keywordSelection.html",controller:"de.cismet.sip-html5-resource-registration.controllers.keywordsController",controllerAs:"keywordsController",keyboard:"true",size:"lg",scope:a})},h.gotoUploadTool=function(){var a=h.config.uploadtool.baseUrl+"?datasetname="+h.dataset.name;c.url(a)},h.checkUploadName=function(){return e.name?!0:(a.message.text="Please enter the name / title of the dataset before uploading ",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetUploadchoiceName",!1)},a.tags["function"]=f.getTagList("function"),a.tags["content type"]=f.getTagList("content type"),a.tags["keywords - X-CUAHSI"]=f.getTagList("keywords - X-CUAHSI"),a.wizard.enterValidators["Dataset Description"]=function(b){return b.valid===!0&&(a.message.text="Please provide some general information about the new dataset such as name, description, a (download) link and keywords.",a.message.icon="fa-info-circle",a.message.type="success"),b.valid},a.wizard.exitValidators["Dataset Description"]=function(b){b.valid=!0;var c=a.tags["content type"].every(function(a){return h.dataset.representation[0]&&h.dataset.representation[0].contenttype&&a.name===h.dataset.representation[0].contenttype.name?(h.dataset.representation[0].contenttype=a,!1):!0}),d=a.tags["function"].every(function(a){return h.dataset.representation[0]&&h.dataset.representation[0]["function"]&&a.name===h.dataset.representation[0]["function"].name?(h.dataset.representation[0]["function"]=a,!1):!0});return e.name?void 0===e.$uploaded?(a.message.text="Please chose wheter you want to upload a new dataset or to provide a link to anexisting dataset.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetUploadchoice",b.valid=!1):d?(a.message.text="Please select a valid function (e.g. download) of the link.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):e.representation[0]["function"]?a.odRegistrationForm.datasetContentlocation.$error.url?(a.message.text="The link to the dataset you have provided is not a valid <a href='https://en.wikipedia.org/wiki/Uniform_Resource_Locator#Syntax' target='_blank' title='Uniform Resource Locator'>URL</a> .",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):e.representation[0].contentlocation?i?(a.message.text=i,a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):c?(a.message.text="Please select a valid content type (e.g. ESRI Shapefile) of the link.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):e.representation[0].contenttype?e.description?h.dataset.tags&&0!==h.dataset.tags.length||(a.message.text="Please assign at least one keyword to the Dataset.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetTags",b.valid=!1):(a.message.text="Please provide a description of the dataset.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetDescription",b.valid=!1):(a.message.text="Please select a valid content type (e.g. ESRI Shapefile) of the link.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):(a.message.text="Please provide link to the dataset.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):(a.message.text="Please select a function (e.g. download) of the link.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetContentlocation",b.valid=!1):(a.message.text="Please enter the name / title of the dataset.",a.message.icon="fa-warning",a.message.type="warning",a.wizard.hasError="datasetName",b.valid=!1),b.valid===!0&&(a.wizard.hasError=null),b.valid}}]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.storageController",["$scope","$http","$window","$interval","$modalInstance","rfc4122","AppConfig","de.cismet.sip-html5-resource-registration.services.dataset","de.cismet.sip-html5-resource-registration.services.TagGroupService","de.cismet.sip-html5-resource-registration.services.storageService",function(a,b,c,d,e,f,g,h,i,j){"use strict";var k,l,m,n;l=(new Date).getTime(),m=c.navigator.userAgent,n=120,k=this,k.dataset=h,k.config=g,k.progress={},k.progress.message=null,k.progress.currval=0,k.progress.active=!0,k.progress.finished=!1,k.progress.error=null,k.progress.type="primary",k.progress.message="The dataset is now beeing added to the SWITCH-ON Meta-Data Repository. <br>Please do not close this browser window until the upload has been completed",k.close=function(){e.close(),c.location.reload()},e.rendered.then(function(){k.dataset.representation.forEach(function(a){n+=10,a.updateTags().then(function(){k.progress.currval+=10}),a.uuid=a.uuid||f.v4()}),i.getTagList("srid","EPSG:4326").$promise.then(function(a){k.dataset.srid=a[0],k.progress.currval+=10}),i.getTagList("conformity","Not evaluated").$promise.then(function(a){k.dataset.conformity=a[0],k.progress.currval+=10}),i.getTagList("language","eng").$promise.then(function(a){k.dataset.language=a[0],k.dataset.metadata[0].language=a[0],k.dataset.metadata[1]&&k.dataset.metadata[1].description&&(k.dataset.metadata[1].language=a[0]),k.progress.currval+=10}),i.getTagList("resource type","open data").$promise.then(function(a){k.dataset.type=a[0],k.progress.currval+=10}),i.getTagList("topic category","climatologyMeteorologyAtmosphere").$promise.then(function(a){k.dataset.topiccategory=a[0],k.progress.currval+=10}),i.getTagList("role","pointOfContact").$promise.then(function(a){k.dataset.contact.organisation||k.dataset.contact.name||k.dataset.contact.description||k.dataset.contact.email||k.dataset.contact.url?k.dataset.contact.role=a[0]:k.dataset.contact=null,k.progress.currval+=10}),i.getTagList("meta-data type","basic meta-data,lineage meta-data").$promise.then(function(a){k.dataset.metadata[0].type=a.getTagByName("basic meta-data"),k.dataset.metadata[1]&&k.dataset.metadata[1].description&&(k.dataset.metadata[1].type=a.getTagByName("lineage meta-data")),k.progress.currval+=10}),i.getTagList("access limitations","limitation not listed").$promise.then(function(a){k.dataset.accesslimitations=a[0],k.progress.currval+=10}),i.getTagList("collection","Open Datasets").$promise.then(function(a){k.dataset.collection=a[0],k.progress.currval+=10}),i.getTagList("meta-data standard","SWITCH-ON SIM").$promise.then(function(a){k.dataset.metadata[0].standard=a[0],k.dataset.metadata[1]&&k.dataset.metadata[1].description&&(k.dataset.metadata[1].standard=a[0]),k.progress.currval+=10}),k.dataset.metadata[0].contenttype=i.getTag("content type","application/json",function(a){k.dataset.metadata[0].contenttype=a}),b({method:"GET",url:k.config.cidsRestApi.host+"/service/status"}).then(function(a){k.dataset.metadata[0].content=JSON.stringify(a.data.$collection),k.dataset.metadata[0].creationdate=l,k.dataset.metadata[0].description=m,k.progress.currval+=10}),k.dataset.representation[0].name||(k.dataset.representation[0].name=k.dataset.name),k.dataset.uuid=k.dataset.uuid||f.v4(),k.dataset.metadata[1]&&k.dataset.metadata[1].description?k.dataset.metadata[1].creationdate=l:k.dataset.metadata.splice(1,1),k.progress.currval+=10}),a.$watch(function(){return k.progress.currval},function(a){if(a&&a===n){var b=d(function(){k.progress.currval<190&&(k.progress.currval+=1)},200,50);j.store(h).$promise.then(function(a){d.cancel(b),k.progress.message="Your dataset has been successfully registered in the SWITCH-ON Spatial Information Platform. Please click <a href='"+g.byod.baseUrl+"/#/resource/"+a.id+"' title='"+a.name+"'>here</a> to view the dataset in the SWITCH-ON BYOD Client.",k.progress.active=!1,k.progress.finished=!0,k.progress.type="success",k.progress.currval=200},function(a){d.cancel(b),a.data.userMessage?k.progress.message="The dataset could not be saved in the Meta-Data Repository: <br>"+a.data.userMessage:this.progress.message="The dataset could not be saved in the Meta-Data Repository.",k.progress.active=!1,k.progress.finished=!0,k.progress.type="danger",k.progress.currval=200})}})}]),angular.module("de.cismet.sip-html5-resource-registration.controllers").controller("de.cismet.sip-html5-resource-registration.controllers.summaryController",["$scope","AppConfig","de.cismet.sip-html5-resource-registration.services.geoTools","de.cismet.sip-html5-resource-registration.services.dataset","leafletData","de.cismet.sip-html5-resource-registration.services.featureRendererService",function(a,b,c,d,e,f){"use strict";var g,h,i,j,k,l,m,n,o,p;g=this,g.dataset=d,g.config=b,g.readOnly=d.$geoserverUploaded,i=c.wicket,j=c.defaultStyle,k=c.defaultDrawOptions,l=c.noDrawOptions,m=c.readSpatialCoverage,n=c.writeSpatialCoverage,h=c.fireResize,o=new L.FeatureGroup,e.getMap("summarymap").then(function(a){a.addLayer(o)}),a.mapData.layers={baselayers:g.config.mapView.baselayers},a.wizard.enterValidators.Summary=function(b){if(b.valid===!0){a.message.text="Please review the meta-data of the dataset and press <strong>Finish</strong> to register the dataset in the SWITCH-ON Spatial Information Platform.",a.message.icon="fa-info-circle",a.message.type="success",h("summarymap");var c=m(g.dataset);void 0!==c&&null!==c&&(o.clearLayers(),o.addLayer(c),e.getMap("summarymap").then(function(a){setTimeout(function(){a.fitBounds(c,{animate:!0,pan:{animate:!0,duration:.75},zoom:{animate:!0}})},100)})),g.readOnly&&void 0===p&&(p=f.getFeatureRenderer(g.dataset),p&&(p.setOpacity(1),e.getMap("summarymap").then(function(a){a.addLayer(p)})))}return b.valid},a.wizard.exitValidators.Summary=function(){return a.wizard.hasError=null,!0}}]),angular.module("de.cismet.sip-html5-resource-registration.directives",[]),angular.module("de.cismet.sip-html5-resource-registration.factories",[]),angular.module("de.cismet.sip-html5-resource-registration.factories").factory("AppConfig",[function(){"use strict";var a={};return a.cidsRestApi={},a.cidsRestApi.host="http://data.water-switch-on.eu/switchon_server_rest",a.searchService={},a.searchService.username="admin@SWITCHON",a.searchService.password="cismet",a.searchService.defautLimit=10,a.searchService.maxLimit=50,a.searchService.host=a.cidsRestApi.host,a.mapView={},a.mapView.backgroundLayer={},a.mapView.baselayers={agtopo:{name:"ArcGis World Topographic",type:"agsBase",layer:"Topographic",visible:!1},agimagery:{name:"ArcGis Imagery",type:"agsBase",layer:"Imagery",visible:!1},opentopo:{name:"OpenTopoMap",url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",type:"xyz",visible:!1,layerOptions:{subdomains:["a","b","c"],attribution:'Map data © <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a> contributors, SRTM | Rendering: © <a href="http://opentopomap.org" target="_blank">OpenTopoMap</a> (CC-BY-SA)'}},osm:{name:"OpenStreetMap",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",type:"xyz",visible:!1,layerOptions:{subdomains:["a","b","c"],attribution:'Map data © <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a> contributors'}},thunderforest:{name:"Thunderforest Landscape",url:"https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey=7feb2dce64d744278b638428463c452f",type:"xyz",visible:!1,layerOptions:{subdomains:["a","b","c"],attribution:'Map data © <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a> contributors, | Rendering: © <a href="http://thunderforest.com" target="_blank">Thunderforest</a>'}},streets:{name:"ArcGis Streets",type:"agsBase",layer:"Streets",visible:!1,layerOptions:{attribution:"Esri"}}},a.mapView.countriesLayer="https://raw.githubusercontent.com/switchonproject/world.geo.json/master/countries.geo.json",a.mapView.home={},a.mapView.home.lat=49.245166,a.mapView.home.lng=6.936809,a.mapView.home.zoom=4,a.mapView.maxBounds={},a.mapView.maxBounds.southWest=[90,-180],a.mapView.maxBounds.northEast=[-90,180],a.mapView.minZoom=2,a.gui={},a.gui.dev=!1,a.objectInfo={},a.objectInfo.resourceJsonUrl="http://"+a.searchService.username+":"+a.searchService.password+"@"+a.searchService.host.replace(/.*?:\/\//g,""),a.objectInfo.resourceXmlUrl="http://data.water-switch-on.eu/csw?request=GetRecordById&service=CSW&version=2.0.2&namespace=xmlns%28csw=http://www.opengis.net/cat/csw/2.0.2%29&resultType=results&outputSchema=http://www.isotc211.org/2005/gmd&outputFormat=application/xml&ElementSetName=full&id=",a.byod={},a.byod.baseUrl="http://www.water-switch-on.eu/sip-webclient/byod",a.uploadtool={},a.uploadtool.baseUrl="http://dl-ng003.xtr.deltares.nl",a}]),angular.module("de.cismet.sip-html5-resource-registration.filters",[]),angular.module("de.cismet.sip-html5-resource-registration.filters").filter("contenttype",function(){"use strict";return function(a){var b=[];return angular.forEach(a,function(a){b.push(a)}),b.sort(function(a,b){return-1!==a.description.indexOf("unknown")?-1:-1!==b.description.indexOf("unknown")?1:a.description.localeCompare(b.description)}),b}}),angular.module("de.cismet.sip-html5-resource-registration.filters").filter("function",function(){"use strict";return function(a){var b=[];return angular.forEach(a,function(a){("download"===a.name||"information"===a.name||"link to order data"===a.name)&&b.push(a)}),b.sort(function(a,b){return a.name.localeCompare(b.name)}),b}}),angular.module("de.cismet.sip-html5-resource-registration.filters").filter("limit",function(){"use strict";return function(a,b,c){return a.slice(b,c)}}),angular.module("de.cismet.sip-html5-resource-registration.filters").filter("htmlToPlaintext",function(){"use strict";return function(a){return a?String(a).replace(/<[^>]+>/gm,""):""}}),angular.module("de.cismet.sip-html5-resource-registration.services",["ngResource"]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.CountriesService",["$resource",function(a){"use strict";var b,c,d,e;return b={"countries-world":"data/countriesWorld.json","countries-europe":"data/countriesEurope.json"},c=[],d=function(d,e){var f;return c.hasOwnProperty(d)?c[d]:b.hasOwnProperty(d)?(f=a(b[d],{},{query:{method:"GET",params:{},isArray:e}}),c[d]=f.query(),c[d]):(console.warn("unknown country group:"+d),null)},e=function(a){return d(a,!0)},{getCountryList:e}}]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.dataset",["$resource","$location","de.cismet.sip-html5-resource-registration.services.RepresentationFactory",function(a,b,c){"use strict";var d=a("data/datasetTemplate.json",{},{query:{method:"GET",params:{},isArray:!1}}).query();return d.$promise.then(function(a){a.$uploaded=void 0,a.$geoserverUploaded=!1;var d=[],e=b.search().representations;e&&(d=JSON.parse(e),Array.isArray(d)&&d.forEach(function(b){a.representation.push(new c(b)),b.wktboundingbox&&!a.spatialcoverage.geo_field&&(a.spatialcoverage.geo_field=b.wktboundingbox,a.$geoserverUploaded=!0)})),a.representation.length>0&&null!==a.representation[0].name?(a.name=a.representation[0].name,a.representation[0].contentlocation&&a.representation[0]["function"].name&&a.representation[0].contenttype.name&&(a.$uploaded=!0)):a.representation[0]=new c}),d}]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.featureRendererService",[function(){"use strict";var a,b,c,d;return b=new Wkt.Wkt,c={color:"#0000FF",fill:!1,weight:2,riseOnHover:!0,clickable:!1},d={fillOpacity:.4,fill:!0,fillColor:"#1589FF",riseOnHover:!0,clickable:!1},a=function(a){var d,e,f;return e=null,a&&a.$self&&"/switchon.resource"===a.$self.substr(0,18).toLowerCase()&&(a.representation&&a.representation.every(function(c){var f,g;return c.name&&c.contentlocation&&c.type&&"aggregated data"===c.type.name&&c["function"]&&"service"===c["function"].name&&c.protocol&&("WWW:TILESERVER"===c.protocol.name?(e=L.tileLayer(c.contentlocation,{tms:"true"}),e.getBounds=function(){return a.spatialcoverage&&a.spatialcoverage.geo_field?(d=a.spatialcoverage.geo_field,b.read(d.substr(d.indexOf(";")+1)),b.toObject().getBounds()):void 0},e.setOpacity(0)):"OGC:WMS-1.1.1-http-get-capabilities"===c.protocol.name&&(f=c.contentlocation,g=c.name,e=L.tileLayer.wms(f,{layers:g,format:"image/png",transparent:!0,version:"1.1.1"}),e.getBounds=function(){return a.spatialcoverage&&a.spatialcoverage.geo_field?(d=a.spatialcoverage.geo_field,b.read(d.substr(d.indexOf(";")+1)),b.toObject().getBounds()):void 0},e.setOpacity(0))),null===e}),!e&&a.spatialcoverage&&a.spatialcoverage.geo_field&&(d=a.spatialcoverage.geo_field,b.read(d.substr(d.indexOf(";")+1)),f=Object.create(c),a.name&&(f.title=a.name),e=b.toObject(f),e.setStyle(c))),e},{getFeatureRenderer:a,defaultStyle:c,highlightStyle:d}}]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.geoTools",["leafletData",function(a){"use strict";var b,c,d,e,f,g,h,i;return b={color:"#0000FF",fillOpacity:.3,weight:2,fill:!0,fillColor:"#1589FF",riseOnHover:!0,clickable:!0},i={color:"#0000FF",weight:2,opacity:.25,fill:!1,riseOnHover:!1,clickable:!1},c={color:"#ff7800",weight:2,opacity:.65,fill:!0,fillOpacity:0,clickable:!0,riseOnHover:!0},e={polyline:!1,polygon:{shapeOptions:b,showArea:!0,metric:!0,allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!</strong>"}},rectangle:{shapeOptions:b,metric:!0},circle:!1,marker:!1},d={polyline:!1,polygon:!1,rectangle:!1,circle:!1,marker:!1},f=function(a){if(a.spatialcoverage&&a.spatialcoverage.geo_field){var c=a.spatialcoverage.geo_field,d=new Wkt.Wkt;-1!==c.indexOf(";")?d.read(c.substr(c.indexOf(";")+1)):d.read(c);var e=a.$geoserverUploaded?i:b,f=d.toObject(e);return f.setStyle(e),f}},g=function(a,b){if(b&&a.spatialcoverage){var c="SRID=4326;"+b;a.spatialcoverage.geo_field=c}},h=function(b){a.getMap(b).then(function(a){setTimeout(function(){a.invalidateSize()},50)})},{defaultStyle:b,readOnlyStyle:i,countriesStyle:c,defaultDrawOptions:e,noDrawOptions:d,readSpatialCoverage:f,writeSpatialCoverage:g,fireResize:h}}]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.RepresentationFactory",["$q","de.cismet.sip-html5-resource-registration.services.TagGroupService",function(a,b){
"use strict";function c(a){var b;if(b=this,b.$self="/SWITCHON.REPRESENTATION/-1",b.id=-1,b.name=null,b.description=null,b.content=null,b.type={},b["function"]={},b.protocol={},b.applicationprofile=null,b.uuid=null,b.temporalresolution=null,b.spatialresolution=null,b.spatialscale=null,b.contentlocation=null,b.tags=null,b.contenttype={},b.uploadstatus=null,b.uploadmessage=null,a)for(var c in a)a.hasOwnProperty(c)&&b.hasOwnProperty(c)&&"$resolved"!==c&&"$promise"!==c&&(null!==b[c]&&"object"==typeof b[c]?b[c].name=a[c]:b[c]=a[c])}return c.prototype.updateTags=function(){var c,d=this;return c=[],d.type||(d.type={}),d.type.name||(d.type.name="original data"),d.type.$self&&d.type.$ref||c.push(b.getTagList("representation type").$promise.then(function(a){d.type=a.getTagByName(d.type.name)})),d.protocol||(d.protocol={}),d.protocol.name||(d.protocol.name="WWW:LINK-1.0-http--link"),d.protocol.$self&&d.protocol.$ref||c.push(b.getTagList("protocol").$promise.then(function(a){d.protocol=a.getTagByName(d.protocol.name)})),d["function"].name||(d["function"]={}),d["function"].name||(d["function"]="download"),d["function"].$self&&d["function"].$ref||c.push(b.getTagList("function").$promise.then(function(a){d["function"]=a.getTagByName(d["function"].name)})),d.contenttype||(d.contenttype={}),d.contenttype.name||(d.contenttype.name="application/octet-stream"),d.contenttype.$self&&d.contenttype.$ref||c.push(b.getTagList("content type").$promise.then(function(a){d.contenttype=a.getTagByName(d.contenttype.name)})),0===c.length&&c.push(a(function(a){setTimeout(function(){a()},500)})),a.all(c)},c.prototype.constructor=c,c}]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.searchService",["$resource","de.cismet.sip-html5-resource-registration.services.Base64","AppConfig",function(a,b,c){"use strict";var d,e,f,g;return d=c.searchService,e=b.encode(d.username+":"+d.password),f=a(d.host+"/searches/SWITCHON.de.cismet.cids.custom.switchon.search.server.ResourceContentLocationSearch/results",{limit:1,offset:0,omitNullValues:!0,deduplicate:!0},{search:{method:"POST",params:{limit:"@limit",offset:"@offset"},isArray:!1,headers:{Authorization:"Basic "+e}}}),g=function(a){var b,c;return b={list:[{key:"url",value:a}]},c=f.search({limit:1,offset:0},b)},{search:g}}]).factory("de.cismet.sip-html5-resource-registration.services.Base64",function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(b){var c,d,e,f,g,h="",i="",j="",k=0;do c=b.charCodeAt(k++),d=b.charCodeAt(k++),i=b.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+a.charAt(e)+a.charAt(f)+a.charAt(g)+a.charAt(j),c=d=i="",e=f=g=j="";while(k<b.length);return h},decode:function(b){var c,d,e,f,g,h="",i="",j="",k=0,l=/[^A-Za-z0-9\+\/\=]/g;l.exec(b)&&console.error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=a.indexOf(b.charAt(k++)),f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),j=a.indexOf(b.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!==g&&(h+=String.fromCharCode(d)),64!==j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<b.length);return h}}}),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.storageService",["$resource","de.cismet.sip-html5-resource-registration.services.Base64","AppConfig",function(a,b,c){"use strict";var d,e,f,g;return d=c.searchService,e=b.encode(d.username+":"+d.password),f=a(d.host+"/SWITCHON.resource",{requestResultingInstance:!0,role:"all"},{store:{method:"POST",isArray:!1,headers:{Authorization:"Basic "+e}}}),g=function(a){var b;return delete a.$uploaded,delete a.$geoserverUploaded,b=f.store(a)},{store:g}}]),angular.module("de.cismet.sip-html5-resource-registration.services").factory("de.cismet.sip-html5-resource-registration.services.TagGroupService",["$resource","de.cismet.sip-html5-resource-registration.services.Base64","AppConfig",function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l;return h={"keyword-x-cuahsi":"X-CUAHSI"},d=[],f=c.searchService,g=b.encode(f.username+":"+f.password),i=a(f.host+"/searches/SWITCHON.de.cismet.cids.custom.switchon.search.server.TagsSearch/results",{limit:100,offset:0,omitNullValues:!0,deduplicate:!0},{search:{method:"POST",params:{},isArray:!1,headers:{Authorization:"Basic "+g}}}),j=function(a,b){var c,d;return c=b?{list:[{key:"taggroup",value:a},{key:"tags",value:b}]}:{list:[{key:"taggroup",value:a}]},d=i.search({},c)},e=function(a,b){var c,f,g;if(d.hasOwnProperty(a)){if(f=d[a],f.$resolved||(console.warn("possible synchonisation problem for taggroup "+a),f.$promise.then(function(){e(a,b)})),!b)return f;var h,i,k;for(h="",i=b.split(","),k=0,g=0;g<i.length;++g)f.getTagByName(i[g])||(k>0&&(h+=","),h+=i[g],k++);if(!(k>0))return f;b=h}else f=[],f.getTagByName=function(a){for(var b=0;b<this.length;b++)if(this[b].name&&this[b].name===a)return this[b];return null};return f.$resolved=!1,c=j(a,b),f.$promise=c.$promise.then(function(a){for(g=0;g<a.$collection.length;g++){var b=a.$collection[g];f.getTagByName(b)||f.push(a.$collection[g])}return f.$resolved=!0,f}),d[a]=f,d[a]},k=function(a,b){return e(a,b)},l=function(a,b,c){if(d.hasOwnProperty(a)){if(d[a].$resolved===!0)return d[a].getTagByName(b);c&&d[a].$promise.then(function(a){var d=a.getTagByName(b);return c(d),d})}else c&&e(a,b).$promise.then(function(a){var d=a.getTagByName(b);return c(d),d});return null},{getTagList:k,getTag:l}}]),angular.module("").run(["$templateCache",function(a){"use strict";a.put("templates/confirmation.html",'<div class=modal-header><h3 class=modal-title>SWITCH-ON Meta-Data Repository Upload</h3></div><div class=modal-body><p class=danger ng-bind-html=storageController.progress.message></p><progressbar class="progress-striped active" ng-class={active:storageController.progress.active} max=200 value=storageController.progress.currval type={{storageController.progress.type}}></progressbar></div><div class=modal-footer><button class="btn btn-primary" type=button ng-disabled=!storageController.progress.finished ng-click=storageController.close()>Close</button></div>'),a.put("templates/geographicLocation.html",'<div class=row ng-controller="de.cismet.sip-html5-resource-registration.controllers.geoLocationController as geoController"><div class=col-md-9><leaflet id=mainmap defaults=mapData.defaults layers=mapData.layers center=mapData.center height=600px width=820px></leaflet></div><div class=col-md-3 ng-if=!geoController.readOnly><div class=row><div class=col-md-12><label>Please select one</label></div></div><div class=row><div class=col-md-12><div class=btn-group-vertical><label class="btn btn-primary" ng-model=geoController.mode.drawBBox ng-click="geoController.switchMode(\'drawBBox\')" btn-radio=true>Define bounding box or polygon</label><label class="btn btn-primary" ng-model=geoController.mode.selectCountry ng-click="geoController.switchMode(\'selectCountry\')" btn-radio=true>Select countries</label><label class="btn btn-primary" ng-model=geoController.mode.defineBBox ng-click="geoController.switchMode(\'defineBBox\')" btn-radio=true>Enter bounding box coordinates</label></div></div></div><div class=row ng-show=geoController.mode.defineBBox><div class=col-md-10><hr><form class=form-horizontal name=forms.coordinatesForm id=forms.coordinatesForm novalidate><div class=row><div class=col-md-12><label class=control-label for=north>North Bound Latitude</label></div></div><div class="row form-group" ng-class="{\'has-error\': !forms.coordinatesForm.north.$error.required && forms.coordinatesForm.north.$invalid,\r\n                                    \'has-success\': !forms.coordinatesForm.north.$error.required && !forms.coordinatesForm.north.$invalid}"><div class=col-md-12><input type=number class=form-control id=north name=north ng-model=geoController.contentLocation.bounds.north ng-change=geoController.applyBoundingBox() min=-90.00000000000000000 max=90.0000000000000000 required></div></div><div class=row><div class=col-md-12><label class=control-label for=east>East Bound Longitude</label></div></div><div class="row form-group" ng-class="{\'has-error\': !forms.coordinatesForm.east.$error.required && forms.coordinatesForm.east.$invalid,\r\n                                    \'has-success\': !forms.coordinatesForm.east.$error.required && !forms.coordinatesForm.east.$invalid}"><div class=col-md-12><input class=form-control type=number id=east name=east ng-model=geoController.contentLocation.bounds.east ng-change=geoController.applyBoundingBox() min=-180.0000000000000000 max=180.0000000000000000 required></div></div><div class=row><div class=col-md-12><label class=control-label for=south>South Bound Latitude</label></div></div><div class="row form-group" ng-class="{\'has-error\': !forms.coordinatesForm.south.$error.required && forms.coordinatesForm.south.$invalid,\r\n                                    \'has-success\': !forms.coordinatesForm.south.$error.required && !forms.coordinatesForm.south.$invalid}"><div class=col-md-12><input type=number class=form-control id=south name=south ng-model=geoController.contentLocation.bounds.south ng-change=geoController.applyBoundingBox() min=-90.00000000000000000 max=90.00000000000000000 required></div></div><div class=row><div class=col-md-12><label class=control-label for=west>West Bound Longitude</label></div></div><div class="row form-group" ng-class="{\'has-error\': !forms.coordinatesForm.west.$error.required && forms.coordinatesForm.west.$invalid,\r\n                                    \'has-success\': !forms.coordinatesForm.west.$error.required && !forms.coordinatesForm.west.$invalid}"><div class=col-md-12><input type=number class=form-control id=west name=west ng-model=geoController.contentLocation.bounds.west ng-change=geoController.applyBoundingBox() min=-180.0000000000000000 max=180.0000000000000000 required></div></div></form></div></div></div></div>'),a.put("templates/keywordSelection.html",'<div class=modal-header><div class=row><div class=col-md-12><h3 class=modal-title>Keyword Selection</h3></div></div><div class=row><div class=col-md-10><p>Please chose one or more <a href="https://www.cuahsi.org/" target=_blank>CUAHSI</a> Keywords from the extended <a href=http://his.cuahsi.org/ontologyfiles.html target=_blank>Hydrologic Ontology for Discovery</a>.</p></div><div class=col-md-2><button class="btn btn-primary pull-right" type=button ng-disabled="dataset.tags.length === 0" ng-click=$dismiss()>Close</button></div></div></div><div class=modal-body><div class="form-group row" ng-show="tags[\'keywords - X-CUAHSI\'].length === 0"><div class=col-md-2></div><div class=col-md-8><p>Please wait while the list of keywords is loaded.</p><progressbar class="progress-striped active" max=100 value=storageController.progress.currval></progressbar></div><div class=col-md-2></div></div><div class="form-group row" ng-show="tags[\'keywords - X-CUAHSI\'].length > 0"><div class=col-md-3><div class=checkbox ng-repeat="tag in tags[\'keywords - X-CUAHSI\']| limit:0:30"><label><input type=checkbox name=selectedKeywords value=tag ng-checked="dataset.tags.indexOf(tag) > -1" ng-click=keywordsController.toggleSelection(tag)> {{tag.name}}</label></div></div><div class=col-md-3><div class=checkbox ng-repeat="tag in tags[\'keywords - X-CUAHSI\']| limit:30:60"><label><input type=checkbox name=selectedKeywords value=tag ng-checked="dataset.tags.indexOf(tag) > -1" ng-click=keywordsController.toggleSelection(tag)> {{tag.name}}</label></div></div><div class=col-md-3><div class=checkbox ng-repeat="tag in tags[\'keywords - X-CUAHSI\']| limit:60:90"><label><input type=checkbox name=selectedKeywords value=tag ng-checked="dataset.tags.indexOf(tag) > -1" ng-click=keywordsController.toggleSelection(tag)> {{tag.name}}</label></div></div><div class=col-md-3><div class=checkbox ng-repeat="tag in tags[\'keywords - X-CUAHSI\']| limit:90:120"><label><input type=checkbox name=selectedKeywords value=tag ng-checked="dataset.tags.indexOf(tag) > -1" ng-click=keywordsController.toggleSelection(tag)> {{tag.name}}</label></div></div></div></div><div class=modal-footer><button class="btn btn-primary" type=button ng-disabled="dataset.tags.length === 0" ng-click=$dismiss()>Close</button></div>'),a.put("templates/licenseAndConditions.html",'<form class=form-horizontal id=licenseForm name=licenseForm ng-controller="de.cismet.sip-html5-resource-registration.controllers.licenseController as licenseController"><div class="row form-group" ng-class="{\'has-error\':wizard.hasError === \'datasetAccessconditions\'}"><label for=datasetAccessconditions class="col-md-2 form-control-label">Access Conditions</label><div class=col-md-3><select class=form-control id=datasetAccessconditions name=datasetAccessconditions ng-options="tag as tag.name for tag in tags[\'accessconditions\'] | orderBy:\'name\' track by tag.name" ng-model=dataset.accessconditions ng-change=showInfoMessage(dataset.accessconditions.description); required></select></div></div><div class="row form-group" ng-class="{\'has-error\':wizard.hasError === \'datasetLicensestatement\'}"><label for=datasetLicensestatement class="col-md-2 form-control-label">License Statement</label><div class=col-md-8><textarea class=form-control id=datasetDescription name=datasetLicensestatement placeholder="Additional conditions for accessing and using the data." rows=6 ng-model=dataset.licensestatement ng-focus="showInfoMessage(\'Please provide a brief statement or URL to the license which applies to the usage of the dataset.\')" ng-required="dataset.accessconditions && dataset.accessconditions.name === \'other\'" ng-disabled="(dataset.accessconditions.name !== \'other\') \r\n                                  && (dataset.accessconditions.name !== \'no limitations\')\r\n                                  && (dataset.accessconditions.name !== \'for research only\')"></textarea></div></div><div class="form-group row" ng-class="{\'has-error\':wizard.hasError === \'datasetContactperson\'}"><label for=datasetContactperson class="col-md-2 form-control-label">Contact Person</label><div class=col-md-5><input class=form-control id=datasetContactperson name=datasetContactperson placeholder="Optional point of contact information" ng-model=dataset.contact.name ng-focus="showInfoMessage(\'Please provide a name of the contact person responsible for the establishment, management, maintenance and distribution of dataset.\');"></div><div class=col-md-3><input type=email class=form-control id=datasetContactperson name=datasetContactemail placeholder="Optional email address" ng-model=dataset.contact.email ng-focus="showInfoMessage(\'Please provide an emal address of the contact person.\');"></div></div><div class="form-group row" ng-class="{\'has-error\':wizard.hasError === \'datasetOrganisation\'}"><label for=datasetOrganisation class="col-md-2 form-control-label">Institution</label><div class=col-md-4><input class=form-control id=datasetOrganisation name=datasetOrganisation placeholder="Optional name of the institution providing the dataset " ng-model=dataset.contact.organisation ng-focus="showInfoMessage(\'Please provide a name of the organisation responsible for the establishment, management, maintenance and distribution of dataset.\');"></div><div class=col-md-4><input type=url class=form-control id=datasetOrganisationurl name=datasetOrganisationurl placeholder="Optional Website of the organisation" ng-model=dataset.contact.url ng-focus="showInfoMessage(\'Please provide the url of the website of the name of the organisation.\');"></div></div><div class="row form-group" ng-class="{\'has-error\':wizard.hasError === \'datasetCitation\'}"><label for=datasetCitation class="col-md-2 form-control-label">Citation / DOI</label><div class=col-md-8><textarea class=form-control id=datasetDescription name=datasetCitation placeholder="Optional citation information" rows=3 ng-model=dataset.contact.description ng-focus="showInfoMessage(\'Please provide bibliographic citation or a Digital Object Identifier (<a href=\\\'https://www.doi.org/\\\' target=\\\'_blank\\\'>DOI</a>).\')">  \r\n            </textarea></div></div><div class="row form-group" ng-class="{\'has-error\':wizard.hasError === \'datasetLineage\'}"><label for=datasetLineage class="col-md-2 form-control-label">Data Lineage</label><div class=col-md-8><textarea class=form-control id=datasetDescription name=datasetLineage placeholder="Optional data lineage / data provenance information" rows=6 ng-model=dataset.metadata[1].description ng-focus="showInfoMessage(\'Provide information on the sources used to create datasets. Links and citations can be included.\')">  \r\n            </textarea></div></div></form>'),a.put("templates/openDataRegistration.html",'<form class=form-horizontal id=odRegistrationForm name=odRegistrationForm ng-controller="de.cismet.sip-html5-resource-registration.controllers.odRegistrationController as odRegistrationController"><div class="form-group row" ng-class="{\'has-error\':wizard.hasError === \'datasetName\'}"><label for=datasetName class="col-md-1 form-control-label">Name</label><div class=col-md-8><div tooltip="{{(dataset.name && dataset.$uploaded === true) ? \'The name of an uploaded dataset cannot be changed afterwards.\' : null}}"><input class="form-control disabled" id=datasetName name=datasetName placeholder="Name of the dataset" ng-model=dataset.name required ng-disabled="dataset.name && dataset.$uploaded === true" ng-focus="showInfoMessage(\'Please provide a characteristic, and often unique, name by which the dataset is known.\');"></div></div></div><div class="row form-group" ng-class="{\'has-error\':wizard.hasError === \'datasetUploadchoice\'}" ng-show="dataset.$uploaded === undefined"><label for=datasetUploadchoice class="col-md-1 form-control-label">Link to Data</label><div class=col-md-10><button class="btn btn-primary" type=button ng-class="{\'btn-danger\':wizard.hasError === \'datasetUploadchoice\'}" ng-click="dataset.$uploaded = false">Provide Link to existing Dataset</button> <span>or</span> <button class="btn btn-primary disabled" type=button ng-class="{\'btn-danger\':(wizard.hasError === \'datasetUploadchoice\' || wizard.hasError === \'datasetUploadchoiceName\')}" tooltip="{{!dataset.name ? \'Please enter the name of the dataset to enable the Data Upload Tool\' : \'Open the Data Upload Tool\'}}" ng-if=!dataset.name>Upload new Dataset</button> <a class="btn btn-primary" type=button ng-class="{\'btn-danger\':(wizard.hasError === \'datasetUploadchoice\' || wizard.hasError === \'datasetUploadchoiceName\')}" ng-href="{{config.uploadtool.baseUrl}}?datasetname={{dataset.name}}" tooltip="{{!dataset.name ? \'Please enter the name of the dataset to enable the Data Upload Tool\' : \'Open the Data Upload Tool\'}}" ng-if=dataset.name>Upload new Dataset</a></div></div><div class="row form-group" ng-class="{\'has-error\':wizard.hasError === \'datasetContentlocation\'}" ng-show="dataset.$uploaded !== undefined" tooltip="{{(dataset.$uploaded === true && dataset.representation[0].contentlocation) ? \'The link of an uploaded dataset cannot be changed afterwards.\' : null}}"><label for=datasetContentlocation class="col-md-1 form-control-label">Link to Data</label><div class=col-md-2><select class=form-control ng-style="(!dataset.representation[0].function \r\n                                && !odRegistrationForm.datasetFunction.$touched) && {\'color\':\'#999999\'}" id=datasetFunction name=datasetFunction placeholder="Type of Link" ng-options="tag as tag.name for tag in tags[\'function\'] | function:\'name\' track by tag.name" ng-model=dataset.representation[0].function ng-change=showInfoMessage(dataset.representation[0].function.description); ng-disabled="dataset.$uploaded === true && dataset.representation[0].function" tooltip="{{(dataset.$uploaded === true && dataset.representation[0].function) ? \'The type of the link of an uploaded dataset cannot be changed afterwards.\' : null}}" required><option style=color:#999999 ng-show=!dataset.representation[0].function value="">Type of Link</select></div><div class=col-md-6><input type=url class=form-control name=datasetContentlocation id=datasetContentlocation placeholder="URL of the dataset" ng-model=dataset.representation[0].contentlocation ng-focus="(wizard.hasError === \'datasetContentlocation\') ? showInfoMessage(\'This dataset is already registered in the SWITCH-ON Spatial Information Platform\', \'info\', \'fa-warning\') : showInfoMessage(\'Please provide a download link to the dataset or a link to additional information about the dataset.\');" ng-change=odRegistrationController.checkLink(dataset.representation[0].contentlocation) ng-model-options="{ debounce: 1000 }" ng-disabled="dataset.$uploaded === true && dataset.representation[0].contentlocation" tooltip="{{(dataset.$uploaded === true && dataset.representation[0].contentlocation) ? \'The link of an uploaded dataset cannot be changed afterwards.\' : null}}" required></div><div class=col-md-3><select class=form-control ng-style="(!dataset.representation[0].contenttype \r\n                                && !odRegistrationForm.datasetContenttype.$touched) && {\'color\':\'#999999\'}" id=datasetContenttype name=datasetContenttype placeholder="Choose file format" ng-options="tag as tag.description for tag in tags[\'content type\'] | contenttype:\'description\' track by tag.name" ng-model=dataset.representation[0].contenttype ng-change="showInfoMessage(\'The <a href=\\\'https://en.wikipedia.org/wiki/Media_type\\\' target=\\\'_blank\\\'>media type</a> of the \' + dataset.representation[0].contenttype.description +  \' dataset file is <i>\'+dataset.representation[0].contenttype.name + \'</i>.\');" required><option style=color:#999999 ng-show=!dataset.representation[0].contenttype value="">Choose file format</select></div></div><div class="form-group row" ng-class="{\'has-error\':wizard.hasError === \'datasetDescription\'}"><label for=datasetDescription class="col-md-1 form-control-label">Description</label><div class=col-md-8><textarea class=form-control id=datasetDescription name=datasetDescription placeholder="Please describe the dataset. Use between 100 and 500 words." rows=8 ng-model=dataset.description ng-focus="showInfoMessage(\'Please provide a brief narrative summary of the content of the dataset. Use between 100 and 500 words.\')" required></textarea></div></div><div class="form-group row"><label class="col-md-1 form-control-label">Keywords</label><div class=col-md-8><div class="form-control switchon-keywords-form" ng-click="showInfoMessage(\'Please select one or more keywords from the <strong>extended</strong> CUAHSI Hydrologic Ontology for Discovery that best characterize the dataset. <br>Please click <a href=\\\'http://his.cuahsi.org/ontologyfiles.html\\\' target=\\\'_blank\\\'>here</a> for more information about the CUAHSI ontology. Get in touch with the <a href=\\\'mailto:switchon.wm@gmail.com\\\'>SWITCH-ON Consortium</a> if you want to make a proposal for new keywords.\'); odRegistrationController.selectKeywords();"><span ng-repeat="tag in dataset.tags"><span class="label label-primary">{{tag.name}}</span></span></div></div></div></form>'),a.put("templates/summary.html",'<div ng-controller="de.cismet.sip-html5-resource-registration.controllers.summaryController as summaryController"><div class=row><div class=col-md-6><div class=row><label class=col-md-3>Name</label><div class=col-md-9>{{dataset.name}}</div></div><div class=row><label class=col-md-3>Link to data</label><div class=col-md-9><a href={{dataset.representation[0].contentlocation}} target=_blank title={{dataset.name}}>{{dataset.representation[0].contentlocation}}</a></div></div><div class=row><label class=col-md-3>Type of Link</label><div class=col-md-9><span class="label label-success" style="text-transform: capitalize" title={{dataset.representation[0].function.description}}>{{dataset.representation[0].function.name}}</span></div></div><div class=row><label class=col-md-3>Format</label><div class=col-md-9><span class="label label-success" title={{dataset.representation[0].contenttype.description}}>{{dataset.representation[0].contenttype.name}}</span></div></div><div class=row><label class=col-md-3>Description</label><div class=col-md-9><p>{{dataset.description}}</p></div></div><div class=row><label class=col-md-3>Keywords</label><div class=col-md-9><span ng-repeat="tag in dataset.tags"><span class="label label-primary">{{tag.name}}</span></span></div></div><div class=row><label class=col-md-3>License</label><div class=col-md-9><span class="label label-warning" title="{{dataset.accessconditions.description | htmlToPlaintext}}">{{dataset.accessconditions.name}}</span></div></div><div class=row ng-if=dataset.licensestatement><label class=col-md-3>License</label><div class=col-md-9><p>{{dataset.licensestatement}}</p></div></div><div class=row ng-if="dataset.contact && dataset.contact.name"><label class=col-md-3>Contact Person</label><div class=col-md-9><span ng-if=dataset.contact.name>{{dataset.contact.name}}</span> <span ng-if=dataset.contact.email>&lt; <a ng-if="dataset.contact.email.indexOf(\' \') === -1" href=mailto:{{dataset.contact.email}}>{{dataset.contact.email}}</a> <span ng-if="dataset.contact.email.indexOf(\' \') !== -1">{{dataset.contact.email}}</span> &gt;</span></div></div><div class=row ng-if="dataset.contact && dataset.contact.organisation"><label class=col-md-3>Institute</label><div class=col-md-9><span ng-if="dataset.contact.organisation && !dataset.contact.url">{{dataset.contact.organisation}}</span> <span ng-if="dataset.contact.organisation && dataset.contact.url"><a href={{dataset.contact.url}} target=_blank rel=nofollow>{{dataset.contact.organisation}}</a></span></div></div><div class=row ng-if="dataset.contact && dataset.contact.description"><label class=col-md-3>Citation / DOI</label><div class=col-md-9>{{dataset.contact.description}}</div></div><div class=row ng-if=dataset.metadata[1].description><label class=col-md-3>Data Lineage</label><div class=col-md-9>{{dataset.metadata[1].description}}</div></div></div><div class=col-md-6><leaflet id=summarymap defaults=mapData.defaults layers=mapData.layers center=mapData.center height=460px width=540px></leaflet></div></div></div>'),a.put("templates/wizard-step-tpl.html",'<section ng-show=selected ng-class="{current: selected, done: completed}" class=step><div class="panel panel-primary"><div class=panel-heading><h1 class=panel-title>{{wzTitle}}</h1></div><div class=panel-body><div ng-transclude></div></div><div class="panel-footer clearfix"><a class="btn btn-primary pull-left" href="mailto:switchon.wm@gmail.com?subject=Open-Data Registration Tool"><span class="fa fa-fw fa-envelope"></span> <span>Feedback</span></a> <button type=button class="btn btn-primary pull-right" wz-next ng-disabled=!wzData.canProceed>{{wzData.proceedButtonText}}</button> <span class=pull-right>&nbsp;</span> <button type=button class="btn btn-default pull-right" wz-previous ng-disabled=!wzData.canGoBack>Previous</button></div></div></section>'),a.put("templates/wizard-tpl.html",'<div><div class=steps ng-transclude></div><ul class="steps-indicator steps-{{getEnabledSteps().length}}" ng-if=!hideIndicators><li ng-class="{default: !step.completed && !step.selected, \r\n                  current: step.selected && !step.completed, \r\n                  done: step.completed && !step.selected, \r\n                  editing: step.selected && step.completed}" ng-repeat="step in getEnabledSteps()"><a ng-click=goTo(step)>{{step.title || step.wzTitle}}</a></li></ul></div>')}]);
//# sourceMappingURL=sip-html5-resource-registration.min.js.map